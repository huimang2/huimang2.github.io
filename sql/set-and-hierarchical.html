<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>SQL - 집합연산자 / 계층형 질의</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css" />

    <!-- 웹 폰트 설정 -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/nanumgothic.css">

    <!-- custom.css -->
    <link rel="stylesheet" type="text/css" href="/assets/css/custom.css" />
    

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- syntax.css -->
    <link rel="stylesheet" href="/assets/css/syntax.css">
    
    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--[if IE]>
        <style>
            p, ol, ul{
                width: 100%;
            }
            blockquote{
                width: 100%;
            }
        </style>
    <![endif]-->
    
    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="프로그래밍 노트" />
    <link rel="shortcut icon" href="https://huimang2.github.io/assets/images/favicon.jpg" type="image/png" />
    <link rel="canonical" href="https://huimang2.github.io/sql/set-and-hierarchical" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="Rubisco's Programming Note" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="SQL - 집합연산자 / 계층형 질의" />
    <meta property="og:description" content="집합연산자(Set Operation) 집합연산자는 두 개 이상의 테이블을 연결하여 하나로 결합하는 연산자 입니다. 집합연산자를 사용하기 위해서는 컬럼의 수와 타입이 동일해야 합니다. 집합연산자에는 다음과 같은 유형이 있습니다. 집합연산자 유형 유형 설명 UNION 합집합 연산을 수행하며, 중복을 제거하여 결과를 표시합니다. UNION ALL 합집합 연산을 수행하며, 중복을 포함하여 결과를 표시합니다. INTERSECT 교집합 연산을 수행합니다." />
    <meta property="og:url" content="https://huimang2.github.io/sql/set-and-hierarchical" />
    <meta property="og:image" content="https://huimang2.github.io/assets/images/sql-logo.png" />
    <meta property="article:publisher" content="https://www.facebook.com/" />
    <meta property="article:author" content="https://www.facebook.com/" />
    <meta property="article:published_time" content="2023-03-29T02:00:00+09:00" />
    <meta property="article:modified_time" content="2023-03-29T02:00:00+09:00" />
    <meta property="article:tag" content="Sql" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="SQL - 집합연산자 / 계층형 질의" />
    <meta name="twitter:description" content="집합연산자(Set Operation) 집합연산자는 두 개 이상의 테이블을 연결하여 하나로 결합하는 연산자 입니다. 집합연산자를 사용하기 위해서는 컬럼의 수와 타입이 동일해야 합니다. 집합연산자에는 다음과 같은 유형이 있습니다. 집합연산자 유형 유형 설명 UNION 합집합 연산을 수행하며, 중복을 제거하여 결과를 표시합니다. UNION ALL 합집합 연산을 수행하며, 중복을 포함하여 결과를 표시합니다. INTERSECT 교집합 연산을 수행합니다." />
    <meta name="twitter:url" content="https://huimang2.github.io/" />
    <meta name="twitter:image" content="https://huimang2.github.io/assets/images/sql-logo.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Rubisco's Programming Note" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Sql" />
    <meta name="twitter:site" content="@" />
    <meta name="twitter:creator" content="@" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "Rubisco's Programming Note",
        "logo": "https://huimang2.github.io/"
    },
    "url": "https://huimang2.github.io/sql/set-and-hierarchical",
    "image": {
        "@type": "ImageObject",
        "url": "https://huimang2.github.io/assets/images/sql-logo.png",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://huimang2.github.io/sql/set-and-hierarchical"
    },
    "description": "집합연산자(Set Operation) 집합연산자는 두 개 이상의 테이블을 연결하여 하나로 결합하는 연산자 입니다. 집합연산자를 사용하기 위해서는 컬럼의 수와 타입이 동일해야 합니다. 집합연산자에는 다음과 같은 유형이 있습니다. 집합연산자 유형 유형 설명 UNION 합집합 연산을 수행하며, 중복을 제거하여 결과를 표시합니다. UNION ALL 합집합 연산을 수행하며, 중복을 포함하여 결과를 표시합니다. INTERSECT 교집합 연산을 수행합니다."
}
    </script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="SQL - 집합연산자 / 계층형 질의" href="/feed.xml" />


    <!-- MathJax -->
    

</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="https://huimang2.github.io/">Rubisco's Programming Note</a>
            
        
        
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
    <li class="nav-java" role="menuitem"><a href="/tag/java/">JAVA</a></li>
    <li class="nav-typescript" role="menuitem"><a href="/tag/typescript/">Typescript</a></li>
    <li class="nav-python" role="menuitem"><a href="/tag/python/">Python</a></li>
    <li class="nav-python" role="menuitem"><a href="/tag/algorithm/">Algorithm</a></li>
    <li class="nav-python" role="menuitem"><a href="/archive.html">All Posts</a></li>
    <li class="nav-python" role="menuitem"><a href="/author_archive.html">Tag별 Posts</a></li>
</ul>

        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
            
        </div>
        
            <a class="subscribe-button" href="#subscribe">Search</a>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full  tag-sql post ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="29 March 2023">29 March 2023</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                                
                                <a href='/tag/sql/'>#SQL</a>
                                
                            
                        
                    
                </section>
                <h1 class="post-full-title">SQL - 집합연산자 / 계층형 질의</h1>
            </header>

            <!-- 
            <figure class="post-full-image" style="background-image: url(/assets/images/sql-logo.png)">
            </figure>
             -->

            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <div id="toc">
                        <ul><li><a href="#집합연산자set-operation"><span>집합연산자(Set Operation)</span></a><ul><li><a href="#union"><span>UNION</span></a></li><li><a href="#union-all"><span>UNION ALL</span></a></li><li><a href="#intersect"><span>INTERSECT</span></a></li><li><a href="#minus"><span>MINUS</span></a></li></ul></li><li><a href="#계층형-질의hierarchical-query"><span>계층형 질의(Hierarchical Query)</span></a></li></ul>

                    </div>
                    <h1 id="집합연산자set-operation">집합연산자(Set Operation)</h1>

<p><code class="language-plaintext highlighter-rouge">집합연산자</code>는 두 개 이상의 테이블을 연결하여 하나로 결합하는 연산자 입니다. 집합연산자를 사용하기 위해서는 컬럼의 수와 타입이 동일해야 합니다.</p>

<p>집합연산자에는 다음과 같은 유형이 있습니다.</p>

<h6 id="집합연산자-유형">집합연산자 유형</h6>

<table>
  <thead>
    <tr>
      <th>유형</th>
      <th>설명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>UNION</td>
      <td>합집합 연산을 수행하며, 중복을 제거하여 결과를 표시합니다.</td>
    </tr>
    <tr>
      <td>UNION ALL</td>
      <td>합집합 연산을 수행하며, 중복을 포함하여 결과를 표시합니다.</td>
    </tr>
    <tr>
      <td>INTERSECT</td>
      <td>교집합 연산을 수행합니다.</td>
    </tr>
    <tr>
      <td>MINUS</td>
      <td>차집합 연산을 수행합니다.</td>
    </tr>
  </tbody>
</table>

<p>기본 구조는 다음과 같습니다.</p>

<h6 id="집합연산자-기본-구조">집합연산자 기본 구조</h6>
<div data-lang="SQL" class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="p">...</span>
<span class="p">[</span><span class="k">UNION</span> <span class="o">|</span> <span class="k">UNION</span> <span class="k">ALL</span> <span class="o">|</span> <span class="k">INTERSECT</span> <span class="o">|</span> <span class="n">MINUS</span><span class="p">]</span>
<span class="k">SELECT</span> <span class="p">...</span>
</code></pre></div></div>

<h2 id="union">UNION</h2>

<p><code class="language-plaintext highlighter-rouge">UNION</code>은 합집합 연산을 수행하며, 중복된 행은 하나로 표시합니다. 내부적으로 중복된 값을 제거하는 과정에서 SORT 기능이 동작합니다.</p>

<p>아래와 같은 예제 데이터가 있습니다.</p>

<h6 id="employees_1">EMPLOYEES_1</h6>

<table>
  <thead>
    <tr>
      <th style="text-align: center">id</th>
      <th style="text-align: center">name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">1</td>
      <td style="text-align: center">Alice</td>
    </tr>
    <tr>
      <td style="text-align: center">2</td>
      <td style="text-align: center">Bob</td>
    </tr>
    <tr>
      <td style="text-align: center">3</td>
      <td style="text-align: center">Charlie</td>
    </tr>
    <tr>
      <td style="text-align: center">4</td>
      <td style="text-align: center">David</td>
    </tr>
  </tbody>
</table>

<h6 id="employees_2">EMPLOYEES_2</h6>

<table>
  <thead>
    <tr>
      <th style="text-align: center">id</th>
      <th style="text-align: center">name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">5</td>
      <td style="text-align: center">Emily</td>
    </tr>
    <tr>
      <td style="text-align: center">2</td>
      <td style="text-align: center">Bob</td>
    </tr>
    <tr>
      <td style="text-align: center">4</td>
      <td style="text-align: center">David</td>
    </tr>
    <tr>
      <td style="text-align: center">6</td>
      <td style="text-align: center">Fiona</td>
    </tr>
  </tbody>
</table>

<p>두 테이블의 결과에 대하여 중복을 제거하여 합쳐 출력하기 위해서는 다음과 같은 쿼리문을 작성하면 됩니다.</p>

<h6 id="union-예제">UNION 예제</h6>
<div data-lang="SQL" class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">ID</span><span class="p">,</span> <span class="n">NAME</span>
  <span class="k">FROM</span> <span class="n">EMPLOYEES_1</span>
<span class="k">UNION</span>
<span class="k">SELECT</span> <span class="n">ID</span><span class="p">,</span> <span class="n">NAME</span>
  <span class="k">FROM</span> <span class="n">EMPLOYEES_2</span>
</code></pre></div></div>

<h6 id="union-결과">UNION 결과</h6>

<table>
  <thead>
    <tr>
      <th style="text-align: center">id</th>
      <th style="text-align: center">name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">1</td>
      <td style="text-align: center">Alice</td>
    </tr>
    <tr>
      <td style="text-align: center">2</td>
      <td style="text-align: center">Bob</td>
    </tr>
    <tr>
      <td style="text-align: center">3</td>
      <td style="text-align: center">Charlie</td>
    </tr>
    <tr>
      <td style="text-align: center">4</td>
      <td style="text-align: center">David</td>
    </tr>
    <tr>
      <td style="text-align: center">5</td>
      <td style="text-align: center">Emily</td>
    </tr>
    <tr>
      <td style="text-align: center">6</td>
      <td style="text-align: center">Fiona</td>
    </tr>
  </tbody>
</table>

<h2 id="union-all">UNION ALL</h2>

<p><code class="language-plaintext highlighter-rouge">UNION ALL</code>은 합집합 연산을 수행하며, 중복된 행을 그대로 표시합니다. UNION과 달리 데이터의 중복을 제거하거나 정렬 과정을 거치지 않기 때문에 성능상 UNION보다 유리합니다.</p>

<h6 id="union-all-예제">UNION ALL 예제</h6>
<div data-lang="SQL" class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">ID</span><span class="p">,</span> <span class="n">NAME</span>
  <span class="k">FROM</span> <span class="n">EMPLOYEES_1</span>
<span class="k">UNION</span> <span class="k">ALL</span>
<span class="k">SELECT</span> <span class="n">ID</span><span class="p">,</span> <span class="n">NAME</span>
  <span class="k">FROM</span> <span class="n">EMPLOYEES_2</span>
</code></pre></div></div>

<h6 id="union-all-결과">UNION ALL 결과</h6>

<table>
  <thead>
    <tr>
      <th style="text-align: center">id</th>
      <th style="text-align: center">name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">1</td>
      <td style="text-align: center">Alice</td>
    </tr>
    <tr>
      <td style="text-align: center">2</td>
      <td style="text-align: center">Bob</td>
    </tr>
    <tr>
      <td style="text-align: center">3</td>
      <td style="text-align: center">Charlie</td>
    </tr>
    <tr>
      <td style="text-align: center">4</td>
      <td style="text-align: center">David</td>
    </tr>
    <tr>
      <td style="text-align: center">5</td>
      <td style="text-align: center">Emily</td>
    </tr>
    <tr>
      <td style="text-align: center">2</td>
      <td style="text-align: center">Bob</td>
    </tr>
    <tr>
      <td style="text-align: center">4</td>
      <td style="text-align: center">David</td>
    </tr>
    <tr>
      <td style="text-align: center">6</td>
      <td style="text-align: center">Fiona</td>
    </tr>
  </tbody>
</table>

<h2 id="intersect">INTERSECT</h2>

<p><code class="language-plaintext highlighter-rouge">INTERSECT</code>는 교집합 연산을 수행하며, 중복된 행은 제거하여 출력합니다.</p>

<h6 id="intersect-예제">INTERSECT 예제</h6>
<div data-lang="SQL" class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">ID</span><span class="p">,</span> <span class="n">NAME</span>
  <span class="k">FROM</span> <span class="n">EMPLOYEES_1</span>
<span class="k">INTERSECT</span>
<span class="k">SELECT</span> <span class="n">ID</span><span class="p">,</span> <span class="n">NAME</span>
  <span class="k">FROM</span> <span class="n">EMPLOYEES_2</span>
</code></pre></div></div>

<h6 id="intersect-결과">INTERSECT 결과</h6>

<table>
  <thead>
    <tr>
      <th style="text-align: center">id</th>
      <th style="text-align: center">name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">1</td>
      <td style="text-align: center">Alice</td>
    </tr>
    <tr>
      <td style="text-align: center">3</td>
      <td style="text-align: center">Charlie</td>
    </tr>
  </tbody>
</table>

<h2 id="minus">MINUS</h2>

<p><code class="language-plaintext highlighter-rouge">MINUS</code>는 차집합 연산을 수행하며, 중복된 행은 제거하여 출력합니다. SQL Server에서는 <code class="language-plaintext highlighter-rouge">EXCEPT</code>를 사용합니다.</p>

<h6 id="minus-예제">MINUS 예제</h6>
<div data-lang="SQL" class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">ID</span><span class="p">,</span> <span class="n">NAME</span>
  <span class="k">FROM</span> <span class="n">EMPLOYEES_1</span>
<span class="n">MINUS</span>
<span class="k">SELECT</span> <span class="n">ID</span><span class="p">,</span> <span class="n">NAME</span>
  <span class="k">FROM</span> <span class="n">EMPLOYEES_2</span>
</code></pre></div></div>

<h6 id="minus-결과">MINUS 결과</h6>

<table>
  <thead>
    <tr>
      <th style="text-align: center">id</th>
      <th style="text-align: center">name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2</td>
      <td style="text-align: center">Bob</td>
    </tr>
    <tr>
      <td style="text-align: center">4</td>
      <td style="text-align: center">David</td>
    </tr>
  </tbody>
</table>

<p>MINUS는 다음과 같이 NOT EXISTS나 NOT IN 서브쿼리를 통해서도 출력할 수 있습니다.</p>

<h6 id="not-exists를-사용한-차집합-예제">NOT EXISTS를 사용한 차집합 예제</h6>
<div data-lang="SQL" class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">ID</span><span class="p">,</span> <span class="n">NAME</span>
  <span class="k">FROM</span> <span class="n">EMPLOYEES_1</span> <span class="n">A</span>
 <span class="k">WHERE</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="p">(</span>
        <span class="k">SELECT</span> <span class="mi">1</span>
          <span class="k">FROM</span> <span class="n">EMPLOYEES_2</span> <span class="n">B</span>
         <span class="k">WHERE</span> <span class="mi">1</span> <span class="o">=</span> <span class="mi">1</span>
           <span class="k">AND</span> <span class="n">A</span><span class="p">.</span><span class="n">ID</span> <span class="o">=</span> <span class="n">B</span><span class="p">.</span><span class="n">ID</span>
           <span class="k">AND</span> <span class="n">A</span><span class="p">.</span><span class="n">NAME</span> <span class="o">=</span> <span class="n">B</span><span class="p">.</span><span class="n">NAME</span>
       <span class="p">)</span>
</code></pre></div></div>

<h6 id="not-in을-사용한-차집합-예제">NOT IN을 사용한 차집합 예제</h6>
<div data-lang="SQL" class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">ID</span><span class="p">,</span> <span class="n">NAME</span>
  <span class="k">FROM</span> <span class="n">EMPLOYEES_1</span>
 <span class="k">WHERE</span> <span class="p">(</span><span class="n">ID</span><span class="p">,</span> <span class="n">NAME</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">ID</span><span class="p">,</span> <span class="n">NAME</span> <span class="k">FROM</span> <span class="n">EMPLOYEES_2</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="계층형-질의hierarchical-query">계층형 질의(Hierarchical Query)</h1>

<p><code class="language-plaintext highlighter-rouge">계층형 질의</code>는 동일한 테이블에 대하여 상위와 하위 포함 관계를 가진 계층형 데이터를 계층형 구조로 조회하기 위한 질의어 입니다.</p>

<p>기본 구조는 다음과 같습니다.</p>

<h6 id="계층형-질의-기본-구조">계층형 질의 기본 구조</h6>
<div data-lang="SQL" class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">SELECT</span> <span class="err">컬럼명</span>
   <span class="k">FROM</span> <span class="err">테이블명</span>
  <span class="k">WHERE</span> <span class="err">조건문</span>
  <span class="k">START</span> <span class="k">WITH</span> <span class="err">조건문</span>
<span class="k">CONNECT</span> <span class="k">BY</span> <span class="p">[</span><span class="n">NOCYCLE</span><span class="p">]</span> <span class="err">조건문</span>
  <span class="k">ORDER</span> <span class="n">SIBLINGS</span> <span class="k">BY</span> <span class="err">컬럼명</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">START WITH</code> 키워드에서는 계층 구조의 시작(ROOT)를 지정하고, <code class="language-plaintext highlighter-rouge">CONNECT BY</code> 키워드에서는 자식 노드의 조건을 설정합니다. 이때 PRIOR 키워드를 사용하는데, 해당 키워드의 위치에 따라 순방향 계층형 질의 또는 역방향 계층형 질의를 할 수 있습니다.</p>

<p>조건문 앞에 <code class="language-plaintext highlighter-rouge">NOCYCLE</code> 키워드를 붙인다면 순환 데이터를 조회하지 않게 됩니다. 즉, 그래프 구조가 아닌 트리형 구조로 데이터를 조회할 수 있습니다.</p>

<p>같은 레벨인 형제 노드 간 정렬을 위해서는 <code class="language-plaintext highlighter-rouge">ORER SIBLINGS BY</code> 키워드를 사용합니다.</p>

<p>계층형 질의문에서는 다음과 같은 가상 컬럼을 사용할 수 있습니다.</p>

<h6 id="계층형-질의문-가상-컬럼">계층형 질의문 가상 컬럼</h6>

<table>
  <thead>
    <tr>
      <th>가상 컬럼</th>
      <th>설명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>LEVEL</td>
      <td>루트 데이터를 1로 하며, 리프 데이터까지 1씩 증가합니다.</td>
    </tr>
    <tr>
      <td>CONNECT_BY_ISLEAF</td>
      <td>리프 데이터이면 1, 아니면 0을 출력합니다.</td>
    </tr>
    <tr>
      <td>CONNECT_BY_ISCYCLE</td>
      <td>사이클이 존재하면 1, 아니면 0을 출력합니다.</td>
    </tr>
  </tbody>
</table>

<p>다음과 같은 함수도 사용할 수 있습니다.</p>

<h6 id="계층형-질의문-함수">계층형 질의문 함수</h6>

<table>
  <thead>
    <tr>
      <th>함수</th>
      <th>설명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>SYS_CONNECT_BY_PATH</td>
      <td>루트 데이터부터 현재 데이터까지의 경로를 출력합니다.</td>
    </tr>
    <tr>
      <td>CONNECT_BY_ROOT</td>
      <td>현재 데이터의 루트 데이터를 출력합니다.</td>
    </tr>
  </tbody>
</table>

<p>예를 들어 아래와 같은 예제 데이터가 있습니다.</p>

<h6 id="employees">EMPLOYEES</h6>

<table>
  <thead>
    <tr>
      <th style="text-align: center">EMPLOYEE_ID</th>
      <th style="text-align: center">EMPLOYEE_NAME</th>
      <th style="text-align: center">MANAGER_ID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">1</td>
      <td style="text-align: center">John</td>
      <td style="text-align: center">NULL</td>
    </tr>
    <tr>
      <td style="text-align: center">2</td>
      <td style="text-align: center">Adam</td>
      <td style="text-align: center">1</td>
    </tr>
    <tr>
      <td style="text-align: center">3</td>
      <td style="text-align: center">Emily</td>
      <td style="text-align: center">1</td>
    </tr>
    <tr>
      <td style="text-align: center">4</td>
      <td style="text-align: center">Sarah</td>
      <td style="text-align: center">2</td>
    </tr>
    <tr>
      <td style="text-align: center">5</td>
      <td style="text-align: center">Tom</td>
      <td style="text-align: center">2</td>
    </tr>
    <tr>
      <td style="text-align: center">6</td>
      <td style="text-align: center">Jason</td>
      <td style="text-align: center">3</td>
    </tr>
    <tr>
      <td style="text-align: center">7</td>
      <td style="text-align: center">Alex</td>
      <td style="text-align: center">4</td>
    </tr>
    <tr>
      <td style="text-align: center">8</td>
      <td style="text-align: center">Chris</td>
      <td style="text-align: center">4</td>
    </tr>
  </tbody>
</table>

<p>MANAGER_ID를 상위노드로 하는 트리구조를 다음 그림과 같이 나타낼 수 있습니다.</p>

<h6 id="트리구조">트리구조</h6>
<p><img src="/assets/images/sql/img018.png" alt="img018" style="margin-top:-1.5em" /></p>

<p>해당 데이터를 계층형 질의문으로 출력해보겠습니다.</p>

<h6 id="계층형-질의문-예제">계층형 질의문 예제</h6>
<div data-lang="SQL" class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">SELECT</span> <span class="n">EMPLOYEES_ID</span>
	   <span class="p">,</span> <span class="n">EMPLOYEES_NAME</span>
	   <span class="p">,</span> <span class="n">MANAGER_ID</span>
	   <span class="p">,</span> <span class="k">LEVEL</span>
	   <span class="p">,</span> <span class="n">CONNECT_BY_ISLEAF</span> <span class="k">AS</span> <span class="n">IS_LEAF</span>
  	 <span class="p">,</span> <span class="n">SYS_CONNECT_BY_PATH</span><span class="p">(</span><span class="n">EMPLOYEES_NAME</span><span class="p">,</span> <span class="s1">'/'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">PATH</span>
	   <span class="p">,</span> <span class="n">CONNECT_BY_ROOT</span><span class="p">(</span><span class="n">EMPLOYEES_NAME</span><span class="p">)</span> <span class="k">AS</span> <span class="n">ROOT</span>
    <span class="k">FROM</span> <span class="n">EMPLOYEES</span>
   <span class="k">START</span> <span class="k">WITH</span> <span class="n">MANAGER_ID</span> <span class="k">IS</span> <span class="k">NULL</span>
 <span class="k">CONNECT</span> <span class="k">BY</span> <span class="n">NOCYCLE</span> <span class="k">PRIOR</span> <span class="n">EMPLOYEES_ID</span> <span class="o">=</span> <span class="n">MANAGER_ID</span>
</code></pre></div></div>

<p>MANAGER_ID가 NULL인 데이터가 루트 노드가 되고, EMPLOYEES_ID의 상위 데이터가 MANAGER_ID인 트리 구조를 DFS로 탐색합니다.
해당 트리는 순방향으로 진행됩니다. 결과는 다음과 같습니다.</p>

<h6 id="계층형-질의문-결과">계층형 질의문 결과</h6>

<table>
  <thead>
    <tr>
      <th style="text-align: center">EMPLOYEES_ID</th>
      <th style="text-align: center">EMPLOYEES_NAME</th>
      <th style="text-align: center">MANAGER_ID</th>
      <th style="text-align: center">LEVEL</th>
      <th style="text-align: center">IS_LEAF</th>
      <th>PATH</th>
      <th style="text-align: center">ROOT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">1</td>
      <td style="text-align: center">John</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td>/John</td>
      <td style="text-align: center">John</td>
    </tr>
    <tr>
      <td style="text-align: center">2</td>
      <td style="text-align: center">Adam</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">0</td>
      <td>/John/Adam</td>
      <td style="text-align: center">John</td>
    </tr>
    <tr>
      <td style="text-align: center">4</td>
      <td style="text-align: center">Sarah</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">0</td>
      <td>/John/Adam/Sarah</td>
      <td style="text-align: center">John</td>
    </tr>
    <tr>
      <td style="text-align: center">7</td>
      <td style="text-align: center">Alex</td>
      <td style="text-align: center">4</td>
      <td style="text-align: center">4</td>
      <td style="text-align: center">1</td>
      <td>/John/Adam/Sarah/Alex</td>
      <td style="text-align: center">John</td>
    </tr>
    <tr>
      <td style="text-align: center">8</td>
      <td style="text-align: center">Chris</td>
      <td style="text-align: center">4</td>
      <td style="text-align: center">4</td>
      <td style="text-align: center">1</td>
      <td>/John/Adam/Sarah/Chris</td>
      <td style="text-align: center">John</td>
    </tr>
    <tr>
      <td style="text-align: center">5</td>
      <td style="text-align: center">Tom</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">1</td>
      <td>/John/Adam/Tom</td>
      <td style="text-align: center">John</td>
    </tr>
    <tr>
      <td style="text-align: center">3</td>
      <td style="text-align: center">Emily</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">0</td>
      <td>/John/Emily</td>
      <td style="text-align: center">John</td>
    </tr>
    <tr>
      <td style="text-align: center">6</td>
      <td style="text-align: center">Jason</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">1</td>
      <td>/John/Emily/Jason</td>
      <td style="text-align: center">John</td>
    </tr>
  </tbody>
</table>

<p>해당 계층형 질의문은 다음과 같이 셀프조인을 통해 나타낼 수도 있습니다.</p>

<h6 id="셀프-조인-예제">셀프 조인 예제</h6>
<div data-lang="SQL" class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">A</span><span class="p">.</span><span class="n">EMPLOYEES_ID</span><span class="p">,</span>
	   <span class="n">A</span><span class="p">.</span><span class="n">EMPLOYEES_NAME</span><span class="p">,</span>
	   <span class="n">A</span><span class="p">.</span><span class="n">MANAGER_ID</span><span class="p">,</span>
	   <span class="n">B</span><span class="p">.</span><span class="n">EMPLOYEES_NAME</span> <span class="k">AS</span> <span class="n">MANAGER_NAME</span>
  <span class="k">FROM</span> <span class="n">EMPLOYEES</span> <span class="n">A</span><span class="p">,</span> <span class="n">EMPLOYEES</span> <span class="n">B</span>
 <span class="k">WHERE</span> <span class="n">B</span><span class="p">.</span><span class="n">EMPLOYEES_ID</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">MANAGER_ID</span><span class="p">;</span>
</code></pre></div></div>

<p>결과는 다음과 같습니다.</p>

<h6 id="셀프-조인-결과">셀프 조인 결과</h6>

<table>
  <thead>
    <tr>
      <th style="text-align: center">EMPLOYEES_ID</th>
      <th style="text-align: center">EMPLOYEES_NAME</th>
      <th style="text-align: center">MANAGER_ID</th>
      <th style="text-align: center">MANAGER_NAME</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">3</td>
      <td style="text-align: center">Emily</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">John</td>
    </tr>
    <tr>
      <td style="text-align: center">2</td>
      <td style="text-align: center">Adam</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">John</td>
    </tr>
    <tr>
      <td style="text-align: center">5</td>
      <td style="text-align: center">Tom</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">Adam</td>
    </tr>
    <tr>
      <td style="text-align: center">4</td>
      <td style="text-align: center">Sarah</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">Adam</td>
    </tr>
    <tr>
      <td style="text-align: center">6</td>
      <td style="text-align: center">Jason</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">Emily</td>
    </tr>
    <tr>
      <td style="text-align: center">8</td>
      <td style="text-align: center">Chris</td>
      <td style="text-align: center">4</td>
      <td style="text-align: center">Sarah</td>
    </tr>
    <tr>
      <td style="text-align: center">7</td>
      <td style="text-align: center">Alex</td>
      <td style="text-align: center">4</td>
      <td style="text-align: center">Sarah</td>
    </tr>
  </tbody>
</table>

                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            <!-- 
                <section class="subscribe-form">
                    <h3 class="subscribe-form-title">Subscribe to Rubisco's Programming Note</h3>
                    <p>Get the latest posts delivered right to your inbox</p>
                    <span id="searchform" method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  />
    <input class="location" type="hidden" name="location"  />
    <input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" onkeyup="myFunc()" 
               id="searchtext" type="text" name="searchtext"  
               placeholder="Search..." />
    </div>
    <script type="text/javascript">
        function myFunc() {
            if(event.keyCode == 13) {
                var url = encodeURIComponent($("#searchtext").val());
                location.href = "/search.html?query=" + url;
            }
        }
    </script>
</span>
                </section>
             -->

            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                
                <!-- /author  -->
            </footer>

            <!-- utterances -->
            <div id="comment">
                <script src="https://utteranc.es/client.js"
                repo="huimang2/huimang2.github.io"
                issue-term="pathname"
                theme="github-light"
                crossorigin="anonymous"
                async></script>
            </div>
        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
                    <article class="read-next-card"
                        
                            style="background-image: url(/assets/images/M31_starspike.jpg)"
                        
                    >
                        <header class="read-next-card-header">
                            <small class="read-next-card-header-sitetitle">&mdash; Rubisco's Programming Note &mdash;</small>
                            
                                <h3 class="read-next-card-header-title"><a href="/tag/sql/">Sql</a></h3>
                            
                        </header>
                        <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
                        <div class="read-next-card-content">
                            <ul>
                                
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/sql/normalization">SQL - 데이터베이스 정규화</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/sql/join">SQL - 조인(JOIN)</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/sql/built-in-function">SQL - 내장 함수(Built-in Function)</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                            </ul>
                        </div>
                        <footer class="read-next-card-footer">
                            <a href="/tag/sql/">
                                
                                    See all 7 posts  →
                                
                            </a>
                        </footer>
                    </article>
                
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/sql/normalization">
                <div class="post-card-image" style="background-image: url(/assets/images/sql-logo.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/sql/normalization">
                <header class="post-card-header">
                    
                        <div class="post-card-tags-container">
                            
                        </div>
                    

                    <h2 class="post-card-title">SQL - 데이터베이스 정규화</h2>
                </header>
                <!-- <section class="post-card-excerpt">
                    
                        <p>정규화(Normalization)

</p>
                    
                </section> -->
            </a>
            <footer class="post-card-meta">
                
                    
                
                <span class="reading-time">
                    
                    
                      2 min read
                    
                </span>
            </footer>
        </div>
    </article>

            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/sql/join">
                <div class="post-card-image" style="background-image: url(/assets/images/sql-logo.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/sql/join">
                <header class="post-card-header">
                    
                        <div class="post-card-tags-container">
                            
                        </div>
                    

                    <h2 class="post-card-title">SQL - 조인(JOIN)</h2>
                </header>
                <!-- <section class="post-card-excerpt">
                    
                        <p>조인(JOIN)

</p>
                    
                </section> -->
            </a>
            <footer class="post-card-meta">
                
                    
                
                <span class="reading-time">
                    
                    
                      5 min read
                    
                </span>
            </footer>
        </div>
    </article>

            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="https://huimang2.github.io/">
            
            <span>Rubisco's Programming Note</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">SQL - 집합연산자 / 계층형 질의</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=SQL+-+%EC%A7%91%ED%95%A9%EC%97%B0%EC%82%B0%EC%9E%90+%2F+%EA%B3%84%EC%B8%B5%ED%98%95+%EC%A7%88%EC%9D%98&amp;url=sql/set-and-hierarchical"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=sql/set-and-hierarchical"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>



        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://huimang2.github.io/">Rubisco's Programming Note</a> &copy; 2023</section>
                <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> &
                    <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> using
                    <a href="https://github.com/jekyllt/jasper2" target="_blank" rel="noopener">Jasper2</a></section>
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    
                    
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    
    <div id="subscribe" class="subscribe-overlay">
        <a class="subscribe-overlay-close" href="#"></a>
        <div class="subscribe-overlay-content">
            
            <h1 class="subscribe-overlay-title">Search Rubisco's Programming Note</h1>
            <p class="subscribe-overlay-description">
            lunr.js를 이용한 posts 검색 </p>
            <span id="searchform" method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  />
    <input class="location" type="hidden" name="location"  />
    <input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" onkeyup="myFunc()" 
               id="searchtext" type="text" name="searchtext"  
               placeholder="Search..." />
    </div>
    <script type="text/javascript">
        function myFunc() {
            if(event.keyCode == 13) {
                var url = encodeURIComponent($("#searchtext").val());
                location.href = "/search.html?query=" + url;
            }
        }
    </script>
</span>
        </div>
    </div>


    <!-- highlight.js -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script> -->

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    /* toc ---------------------------------------------------------------------*/

    var tocTitle = document.getElementsByClassName("post-full-title")[0];
    var tocTitleY = window.pageYOffset + title.getBoundingClientRect().top;
    
    var tocArticle = document.getElementsByClassName("post-full-content")[0];
    var tocArticleY = window.pageYOffset + tocArticle.getBoundingClientRect().top;
  
    var toc = document.getElementById("toc");
    var tocHeaderNodes = getHeaderNodes(tocArticle);
    var tocNodes = getTOCNodes(toc);
  
    var tocBefore = undefined;

    function getTOCNodes(master) {
        var nodes = Array.prototype.slice.call(master.getElementsByTagName("*"), 0);
        var tocNodes = nodes.filter(function(elem) {
            return elem.tagName == "A";
        });
        return tocNodes;
    }
    
    function getHeaderNodes(master) {
        var nodes = Array.prototype.slice.call(master.getElementsByTagName("*"), 0);
        var headerNodes = nodes.filter(function(elem) {
            return elem.tagName == "H1" || elem.tagName == "H2" || elem.tagName == "H3" && !elem.classList.contains('no-toc');
        });
        return headerNodes;
    }

    tocNodes.forEach(el => {
        el.addEventListener('click', function(e){
            e.preventDefault();
            let id = this.getAttribute('href').slice(1);
            window.scrollTo(window.scrollX, window.scrollY + document.getElementById(id).getBoundingClientRect().top - 80);
        });
    });

    document.querySelector('.post-full-content').querySelectorAll('p a[href^="#"]').forEach(el => {
        el.addEventListener('click', function(e){
            e.preventDefault();
            let id = this.getAttribute('href').slice(1);
            window.scrollTo(window.scrollX, window.scrollY + document.getElementById(id).getBoundingClientRect().top - 80);
        });
    });

    /*--------------------------------------------------------------------------*/

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 30;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
            toc.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
            toc.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;

        // toc
        var tocCurrent = tocHeaderNodes.filter(function(header) {
            var headerY = window.pageYOffset + header.getBoundingClientRect().top;
            return window.scrollY >= headerY - 90;
        });
  
        if (tocCurrent.length > 0) {
            tocCurrent = tocCurrent[tocCurrent.length-1];
  
            var tocCurrentA = tocNodes.filter(function(tocNode) {
                return tocNode.getElementsByTagName("span")[0].innerHTML == tocCurrent.innerHTML;
            })
            
            tocCurrentA = tocCurrentA[0];

            if (tocCurrentA) {
                if (tocBefore == undefined) tocBefore = tocCurrentA;
    
                if (tocBefore != tocCurrentA) {
                    tocBefore.classList.remove("toc-active");
                    tocBefore = tocCurrentA;
                }
    
                tocCurrentA.classList.add("toc-active");
            }
            else {
                if (tocBefore) 
                    tocBefore.classList.remove("toc-active");
            }
        }
        else {
            if (tocBefore) 
                tocBefore.classList.remove("toc-active");
        }
        
        if(toc && tocArticle.getBoundingClientRect().bottom <= 0) {
            toc.classList.add('toc-hidden');
        } else {
            toc.classList.remove('toc-hidden');
        }
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
