<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>프로세스</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css" />

    <!-- 웹 폰트 설정 -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/nanumgothic.css">

    <!-- custom.css -->
    <link rel="stylesheet" type="text/css" href="/assets/css/custom.css" />
    

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- syntax.css -->
    <link rel="stylesheet" href="/assets/css/syntax.css">
    
    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--[if IE]>
        <style>
            p, ol, ul{
                width: 100%;
            }
            blockquote{
                width: 100%;
            }
        </style>
    <![endif]-->
    
    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="프로그래밍 노트" />
    <link rel="shortcut icon" href="https://huimang2.github.io/assets/images/favicon.jpg" type="image/png" />
    <link rel="canonical" href="https://huimang2.github.io/etc/computer-process" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="Rubisco's Programming Note" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="프로세스" />
    <meta property="og:description" content="프로세스(Process) 프로세스(Process)란 현재 실행되고 있는 프로그램의 인스턴스를 말합니다. 프로그램은 데이터 상태로 보조기억장치에 저장되어 있으며, 프로그램이 실행되면 메모리에 적재되어 프로세스가 됩니다. 윈도우에서 작업 관리자를 열면 현재 실행중인 프로세스를 확인할 수 있습니다. 프로세스는 포그라운드 프로세스(Foreground Process)와 백그라운드 프로세스(Background Process)로 나눌 수 있습니다. 포그라운드 프로세스(Foreground Process)는 사용자와 상호작용하면서 실행되는 프로세스입니다. 이 프로세스는 주로" />
    <meta property="og:url" content="https://huimang2.github.io/etc/computer-process" />
    <meta property="og:image" content="https://huimang2.github.io/assets/images/computer-logo.png" />
    <meta property="article:publisher" content="https://www.facebook.com/" />
    <meta property="article:author" content="https://www.facebook.com/" />
    <meta property="article:published_time" content="2023-06-18T01:00:00+09:00" />
    <meta property="article:modified_time" content="2023-06-18T01:00:00+09:00" />
    <meta property="article:tag" content="Etc" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="프로세스" />
    <meta name="twitter:description" content="프로세스(Process) 프로세스(Process)란 현재 실행되고 있는 프로그램의 인스턴스를 말합니다. 프로그램은 데이터 상태로 보조기억장치에 저장되어 있으며, 프로그램이 실행되면 메모리에 적재되어 프로세스가 됩니다. 윈도우에서 작업 관리자를 열면 현재 실행중인 프로세스를 확인할 수 있습니다. 프로세스는 포그라운드 프로세스(Foreground Process)와 백그라운드 프로세스(Background Process)로 나눌 수 있습니다. 포그라운드 프로세스(Foreground Process)는 사용자와 상호작용하면서 실행되는 프로세스입니다. 이 프로세스는 주로" />
    <meta name="twitter:url" content="https://huimang2.github.io/" />
    <meta name="twitter:image" content="https://huimang2.github.io/assets/images/computer-logo.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Rubisco's Programming Note" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Etc" />
    <meta name="twitter:site" content="@" />
    <meta name="twitter:creator" content="@" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "Rubisco's Programming Note",
        "logo": "https://huimang2.github.io/"
    },
    "url": "https://huimang2.github.io/etc/computer-process",
    "image": {
        "@type": "ImageObject",
        "url": "https://huimang2.github.io/assets/images/computer-logo.png",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://huimang2.github.io/etc/computer-process"
    },
    "description": "프로세스(Process) 프로세스(Process)란 현재 실행되고 있는 프로그램의 인스턴스를 말합니다. 프로그램은 데이터 상태로 보조기억장치에 저장되어 있으며, 프로그램이 실행되면 메모리에 적재되어 프로세스가 됩니다. 윈도우에서 작업 관리자를 열면 현재 실행중인 프로세스를 확인할 수 있습니다. 프로세스는 포그라운드 프로세스(Foreground Process)와 백그라운드 프로세스(Background Process)로 나눌 수 있습니다. 포그라운드 프로세스(Foreground Process)는 사용자와 상호작용하면서 실행되는 프로세스입니다. 이 프로세스는 주로"
}
    </script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="프로세스" href="/feed.xml" />


    <!-- MathJax -->
    
        <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      TeX: {
        equationNumbers: {
          autoNumber: "AMS"
        },
        extensions: ["color.js"]
      },
      tex2jax: {
        inlineMath: [ ['$', '$'] ],
        displayMath: [ ['$$', '$$'] ],
        processEscapes: true,
      },
      displayAlign: "left"
    });
    MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
    MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
    </script>
    <script type="text/javascript" async
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    

</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="https://huimang2.github.io/">Rubisco's Programming Note</a>
            
        
        
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
    <li class="nav-java" role="menuitem"><a href="/tag/java/">JAVA</a></li>
    <li class="nav-typescript" role="menuitem"><a href="/tag/typescript/">Typescript</a></li>
    <li class="nav-python" role="menuitem"><a href="/tag/python/">Python</a></li>
    <li class="nav-python" role="menuitem"><a href="/tag/algorithm/">Algorithm</a></li>
    <li class="nav-python" role="menuitem"><a href="/archive.html">All Posts</a></li>
    <li class="nav-python" role="menuitem"><a href="/author_archive.html">Tag별 Posts</a></li>
</ul>

        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
            
        </div>
        
            <a class="subscribe-button" href="#subscribe">Search</a>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full  tag-etc post ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="18 June 2023">18 June 2023</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                                
                                <a href='/tag/etc/'>#기타</a>
                                
                            
                        
                    
                </section>
                <h1 class="post-full-title">프로세스</h1>
            </header>

            <!-- 
            <figure class="post-full-image" style="background-image: url(/assets/images/computer-logo.png)">
            </figure>
             -->

            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <div id="toc">
                        <ul><li><a href="#프로세스process"><span>프로세스(Process)</span></a></li><li><a href="#프로세스-제어-블록process-control-block-pcb"><span>프로세스 제어 블록(Process Control Block, PCB)</span></a></li><li><a href="#프로세스-상태"><span>프로세스 상태</span></a></li><li><a href="#문맥-교환context-switch"><span>문맥 교환(Context Switch)</span></a></li><li><a href="#프로세스의-구소"><span>프로세스의 구소</span></a></li><li><a href="#프로세스의-생성"><span>프로세스의 생성</span></a></li></ul>

                    </div>
                    <h1 id="프로세스process">프로세스(Process)</h1>

<p><code class="language-plaintext highlighter-rouge">프로세스(Process)</code>란 현재 실행되고 있는 프로그램의 인스턴스를 말합니다. 프로그램은 데이터 상태로 보조기억장치에 저장되어 있으며, 프로그램이 실행되면 메모리에 적재되어 프로세스가 됩니다. 윈도우에서 작업 관리자를 열면 현재 실행중인 프로세스를 확인할 수 있습니다.</p>

<p><img src="/assets/images/computer/img112.png" alt="img112" /></p>

<p>프로세스는 <code class="language-plaintext highlighter-rouge">포그라운드 프로세스(Foreground Process)</code>와 <code class="language-plaintext highlighter-rouge">백그라운드 프로세스(Background Process)</code>로 나눌 수 있습니다.</p>

<p><code class="language-plaintext highlighter-rouge">포그라운드 프로세스(Foreground Process)</code>는 사용자와 상호작용하면서 실행되는 프로세스입니다. 이 프로세스는 주로 사용자 인터페이스를 통해 입력을 받거나 출력을 제공하며, 사용자의 명령을 처리하거나 작업을 수행합니다. 포그라운드 프로세스는 사용자가 직접 볼 수 있고 제어할 수 있으며, 사용자와의 상호작용을 위해 우선순위를 가지고 실행됩니다.</p>

<p><code class="language-plaintext highlighter-rouge">백그라운드 프로세스(Background Process)</code>는 사용자와 상호작용하지 않고 실행되는 프로세스입니다. 이러한 프로세스는 주로 시스템 작업이나 보조 작업을 처리하는 데 사용됩니다. 백그라운드 프로세스는 사용자의 입력이나 제어를 기다리지 않고 실행되므로 보다 높은 우선순위를 가질 수 있습니다. 일반적으로 백그라운드 프로세스는 시간이 오래 걸리는 작업이나 자동화된 작업을 처리하는 데 사용됩니다.</p>

<p>예를 들어, 웹 브라우저를 실행한다고 가정해 봅시다. 웹 브라우저 자체는 포그라운드 프로세스로 실행되며, 사용자가 웹 페이지를 찾아보거나 입력을 하면 이를 처리합니다. 그러나 웹 브라우저에서 파일을 다운로드하는 경우, 다운로드 작업은 백그라운드 프로세스로 실행됩니다. 사용자는 다운로드 작업이 백그라운드에서 진행되는 동안에도 브라우저를 계속 사용할 수 있습니다.</p>

<p>백그라운드 프로세스는 다운로드와 같이 사용자와 상호작용이 가능한 백그라운드 프로세스와 사용자와 상호작용하지 않고 정해진 작업만 수행하는 백그라운드 프로세스로 나눌 수 있습니다. 후자의 경우를 <code class="language-plaintext highlighter-rouge">데몬(Daemon)</code> 또는 <code class="language-plaintext highlighter-rouge">서비스(Service)</code> 라고 합니다.</p>

<h6 id="윈도우-서비스">윈도우 서비스</h6>
<p><img src="/assets/images/computer/img119.png" alt="img119" /></p>

<h1 id="프로세스-제어-블록process-control-block-pcb">프로세스 제어 블록(Process Control Block, PCB)</h1>

<p><code class="language-plaintext highlighter-rouge">프로세스 제어 블록(Process Control Block, PCB)</code>은 운영체제에서 프로세스를 관리하기 위해 사용되는 데이터 구조입니다.</p>

<p>CPU는 한정된 자원을 가지기 때문에 프로세스는 돌아가면서 한정된 시간만큼 CPU를 사용합니다. 자신의 차례에 정해진 시간만큼 CPU를 사용하고 타이머 인터럽트가 발생하면 다음 프로세스에게 차례를 양보합니다. 운영 체제는 빠르게 번갈아 수행되는 프로세스를 관리할 필요가 있는데, 이를 위해 PCB를 사용합니다.</p>

<p>운영체제는 각 프로세스에 대해 PCB를 커널 영역에 생성하고 프로세스의 상태 및 관련 정보를 추적합니다. 이러한 정보는 운영 체제가 프로세스를 스케줄링하고 제어하는 데 필요한 기반이 됩니다.</p>

<p>PCB는 프로세스의 상태, 우선 순위, 레지스터 값, 메모리 할당 정보, 입출력 상태 등 다양한 정보를 포함합니다.</p>

<p><strong><font color="royalBlue">1. 프로세스 식별자(Process ID, PID)</font>:</strong> 각 프로세스를 고유하게 식별하는 번호 또는 이름입니다. PID는 운영 체제에서 프로세스를 식별하는 데 사용됩니다.</p>

<p><strong><font color="royalBlue">2. 프로세스 상태(Process State)</font>:</strong> 프로세스의 현재 상태를 나타냅니다. 프로세스 상태는 <strong>실행(Running)</strong>, <strong>대기(Waiting)</strong>, <strong>준비(Ready)</strong> 등이 있습니다. 운영 체제는 이 정보를 기반으로 프로세스를 스케줄링하고 상태 전이를 관리합니다.</p>

<p><strong><font color="royalBlue">3. 프로그램 카운터(Program Counter, PC)</font>:</strong> 현재 실행 중인 명령어의 주소를 가리키는 레지스터 값입니다. 프로세스는 다음에 실행할 명령어를 PC의 값에 따라 결정합니다.</p>

<p><strong><font color="royalBlue">4. 레지스터(Register) 값</font>:</strong> 프로세스가 현재 사용 중인 레지스터의 값을 저장합니다. 이는 프로세스가 실행되는 동안 레지스터 값이 유지되도록 합니다.</p>

<p><strong><font color="royalBlue">5.스케줄링 정보(Scheduling Information)</font>:</strong> 프로세스의 우선 순위, CPU 점유 시간, 대기 시간 등 스케줄링과 관련된 정보를 포함합니다. 운영 체제는 이 정보를 기반으로 프로세스 스케줄링 알고리즘을 실행하여 어떤 프로세스를 실행시킬지 결정합니다.</p>

<p><strong><font color="royalBlue">6.메모리 관리 정보(Memory Management Information)</font>:</strong> 프로세스가 사용하는 메모리 주소 범위, 페이지 테이블 정보 등과 같은 메모리 관리에 필요한 정보를 포함합니다.</p>

<p><strong><font color="royalBlue">7.입출력 상태(I/O Status)</font>:</strong> 프로세스가 사용 중인 입출력 장치와 관련된 정보를 저장합니다. 이 정보는 프로세스가 입출력 작업을 수행하는 데 필요합니다.</p>

<h1 id="프로세스-상태">프로세스 상태</h1>

<p>프로세스는 <code class="language-plaintext highlighter-rouge">생성(New)</code>, <code class="language-plaintext highlighter-rouge">준비(Ready)</code>, <code class="language-plaintext highlighter-rouge">실행(Run)</code>, <code class="language-plaintext highlighter-rouge">대기(Wait)</code>, <code class="language-plaintext highlighter-rouge">종료(Exit)</code> 5가지 상태를 가집니다. 프로세스 상태는 운영 체제가 프로세스의 상태 전이를 관리하고 스케줄링을 수행하기 위해 사용됩니다. 스케줄러는 준비 상태에 있는 프로세스를 실행 상태로 전환하고, 대기 상태에 있는 프로세스를 준비 상태로 전환하여 CPU 할당을 조정합니다. 이를 통해 CPU 자원을 효율적으로 활용하고 다중 프로세스가 동시에 실행될 수 있게 됩니다.</p>

<p><img src="/assets/images/computer/img123.png" alt="img123" /></p>

<p><code class="language-plaintext bgcolor blue highlighter-rouge" style="color:royalblue">생성 상태(create status)</code>는 프로세스가 생성되었지만 아직 실행되기 전인 상태입니다. 이 단계에서는 프로세스가 초기화되고 필요한 자원이 할당됩니다. PCB는 이때 생성됩니다.</p>

<p><code class="language-plaintext bgcolor blue highlighter-rouge" style="color:royalblue">준비 상태(ready status)</code>는 프로세스가 실행을 기다리는 상태입니다. 필요한 자원을 모두 할당받았으며, CPU를 할당받기를 기다리는 상태입니다. 스케줄러에 의해 다음에 실행될 프로세스로 선택될 수 있습니다.</p>

<p><code class="language-plaintext bgcolor blue highlighter-rouge" style="color:royalblue">실행 상태(runnig status)</code>는 준비 상태에 있는 프로세스가 CPU를 할당받아 실행되고 있는 상태입니다. 준비 상태에 있는 프로세스가 실행 상태가 되는 것을 <code class="language-plaintext highlighter-rouge">디스패치(Dispatch)</code>라고 합니다. 이때 프로세스는 CPU를 사용하여 명령어를 실행하고 작업을 수행합니다. 실행 상태에서는 시간이 지남에 따라 프로세스는 완료되거나 대기 상태로 전환될 수 있습니다. 실행 상태의 프로세스가 대기 상태가 되는 것을 <code class="language-plaintext highlighter-rouge">Block</code> 이라고 합니다.</p>

<p><code class="language-plaintext bgcolor blue highlighter-rouge" style="color:royalblue">대기 상태(blocking status)</code>는 프로세스가 어떤 이벤트를 기다리는 상태입니다. 이벤트는 입출력 완료, 사용자 입력, 시간 지연 등 다양한 상황일 수 있습니다. 대기 상태에 있는 프로세스는 CPU를 사용할 수 없으며, 해당 이벤트가 발생할 때까지 기다리게 됩니다. CPU에 비해 느린 입출력 작업의 경우 대기상태로 있다가 입출력 완료 인터럽트 신호를 받으면 준비 상태로 전환됩니다. 대기 상태의 프로세스가 준비 상태가 되는 것을 <code class="language-plaintext highlighter-rouge">Wake up</code> 이라고 합니다.</p>

<p><code class="language-plaintext bgcolor blue highlighter-rouge" style="color:royalblue">종료 상태(terminate status)</code>는 프로세스가 완료되거나 종료된 상태입니다. 프로세스의 실행이 끝났거나, 강제로 종료되었을 때 이 상태로 전환됩니다. 종료된 프로세스는 시스템에서 제거됩니다.</p>

<h1 id="문맥-교환context-switch">문맥 교환(Context Switch)</h1>

<p><code class="language-plaintext highlighter-rouge">문맥 교환(Context Switching)</code>은 운영 체제에서 한 프로세스의 실행 상태를 저장하고 다른 프로세스의 실행 상태로 전환하는 과정을 말합니다.</p>

<p><code class="language-plaintext highlighter-rouge">문맥(Context)</code>이란 프로그램 카운터 등 프로세스가 다음 차례가 왔을 때 실행을 재개하기 위한 PCB 정보를 말합니다. 문맥을 백업해두면 언제든지 프로세스의 실행을 재개할 수 있습니다.</p>

<p><img src="/assets/images/computer/img120.png" alt="img120" /></p>

<p>문맥 교환은 멀티태스킹 환경에서 여러 프로세스가 동시에 실행되는 상황에서 CPU의 할당을 조정하기 위해 필요합니다.</p>

<h1 id="프로세스의-구소">프로세스의 구소</h1>

<p>메모리는 <code class="language-plaintext highlighter-rouge">커널 영역</code>과 <code class="language-plaintext highlighter-rouge">사용자 영역</code>으로 나눌 수 있습니다. 사용자 영역에서 프로세스는 다시 <code class="language-plaintext highlighter-rouge">코드(Code) 영역</code>, <code class="language-plaintext highlighter-rouge">데이터(Data) 영역</code>, <code class="language-plaintext highlighter-rouge">힙(Heap) 영역</code>, <code class="language-plaintext highlighter-rouge">스택(Stack) 영역</code> 등으로 나눌 수 있습니다.</p>

<p><img src="/assets/images/computer/img121.png" alt="img121" /></p>

<p><code class="language-plaintext bgcolor blue highlighter-rouge" style="color:royalblue">커널 영역</code>에는 위에서 설명했듯이 PCB가 저장됩니다.</p>

<p><code class="language-plaintext bgcolor blue highlighter-rouge" style="color:royalblue">코드 영역</code>에는 실행하는 프로그램의 코드가 기계어로 저장되며, <code class="language-plaintext highlighter-rouge">텍스트(Text) 영역</code>이라고도 합니다. 데이터가 아닌 CPU가 실행할 명령어가 저장되어 있어서 쓰기가 금지된 read-only 영역입니다. CPU는 코드 영역에 저장된 명령어를 하나씩 처리하게 됩니다.</p>

<p><code class="language-plaintext bgcolor blue highlighter-rouge" style="color:royalblue">데이터 영역</code>에는 프로그램이 실행되는 동안 유지할 데이터가 저장됩니다. 일반적으로 <code class="language-plaintext highlighter-rouge">전역 변수(global variable)</code>나 <code class="language-plaintext highlighter-rouge">정적 변수(static variable)</code>가 저장되며, 프로그램이 실행될 때 할당되고 프로그램이 종료되면 소멸합니다.</p>

<p><code class="language-plaintext bgcolor blue highlighter-rouge" style="color:royalblue">힙 영역</code>은 사용자가 직접 관리할 수 있는 메모리 영역으로, 런 타임에 할당받을 메모리 크기가 결정됩니다. 예를 들어 C언어에서 동적 크기의 배열을 선언하거나 자바에서 new 명령어를 통해 인스턴스를 생성하면 동적으로 힙 영역을 할당받아 데이터가 저장됩니다.</p>

<p>힙 영역은 사용자가 직접 메모리를 반환해야 하며, 메모리를 반환하지 않으면 지속적으로 메모리 공간을 차지하는 <code class="language-plaintext highlighter-rouge">메모리 누수(Memory Leak)</code> 현상이 발생합니다. C언어에서는 <code class="language-plaintext highlighter-rouge">free</code> 함수를 통해 메모리를 반환하며, 자바의 경우 <code class="language-plaintext highlighter-rouge">가비지 콜렉션(Garbage Collection)</code>에 의해 자동으로 메모리가 반환됩니다.</p>

<p><code class="language-plaintext bgcolor blue highlighter-rouge" style="color:royalblue">스택 영역</code>은 함수 호출 시 생성되는 <code class="language-plaintext highlighter-rouge">지역 변수(local variable)</code>나 <code class="language-plaintext highlighter-rouge">매개 변수(parameter)</code> 등의 데이터가 일시적으로 저장되는 영역으로, 컴파일 타임에 할당받을 메모리 크기가 결정됩니다. 함수를 호출하면 동적으로 스택 영역을 할당받아 데이터가 저장되고, 함수의 호출이 완료되면 할당받은 메모리를 반환합니다.</p>

<p>스택 영역은 <code class="language-plaintext highlighter-rouge">푸시(push)</code> 동작으로 데이터를 저장하고 <code class="language-plaintext highlighter-rouge">팝(pop)</code> 동작으로 데이터를 인출합니다. 데이터 인출시 <code class="language-plaintext highlighter-rouge">후입선출(Last-In First-Out, LIFO)</code> 방식에 따라 동작하므로, 가장 늦게 저장된 데이터가 가장 먼저 인출됩니다.</p>

<hr />

<p>코드 영역과 데이터 영역은 프로그램 시작시 고정적으로 메모리를 할당받기 때문에 <code class="language-plaintext highlighter-rouge">정적 할당 영역</code> 이라고 하며, 힙 영역과 스택 영역은 메모리를 동적으로 할당받기 때문에 <code class="language-plaintext highlighter-rouge">동적 할당 영역</code> 이라고 합니다.</p>

<p>동적 할당 영역에서 힙 영역은 낮은 주소에서 높은 주소 방향으로 메모리가 할당되고, 스택 영역은 높은 주소에서 낮은 주소 방향으로 메모리가 할당됩니다.</p>

<p><img src="/assets/images/computer/img122.png" alt="img122" /></p>

<p>만약 두 영역이 겹쳐 할당받을 메모리가 없게 된다면 서로의 영역을 침범할 수 있습니다. 이때 스택이 힙 영역을 침범하는 경우를 <code class="language-plaintext highlighter-rouge">스택 오버플로우(Stack Overflow)</code>, 힙이 스택 영역을 침범하는 경우를 <code class="language-plaintext highlighter-rouge">힙 오버플로우(Heap Overflow)</code>라고 합니다.</p>

<h1 id="프로세스의-생성">프로세스의 생성</h1>

<p>프로세스는 프로그램을 실행할 때 생성됩니다. 이때 운영체제가 프로그램 코드를 메모리 코드영역에 할당하고 PCB를 생성한 후 메모리에 데이터 영역과 스택 영역을 확보하여 프로세스를 실행합니다.</p>

<p>유닉스 계열의 운영체제의 경우 새로운 프로세스를 생성할 때 위 과정을 모두 거치지 않고 <code class="language-plaintext highlighter-rouge">fork</code> 시스템 호출을 통해 기존 프로세스 복사하여 새로운 프로세스를 생성합니다. 이때 fork 시스템 호출을 하는 프로세스는 부모 프로세스, 새로 만들어진 프로세스는 자식 프로세스가 되어 계층 구조를 형성합니다.</p>

<p>fork를 호출하면 PCB를 포함한 부모 프로세스 대부분이 자식 프로세스에 복사되어 동일한 프로세스가 생성됩니다. 다만 PID, PPID, CPID 등 일부 데이터가 수정됩니다. PPID는 부모 프로세스의 PID, CPID는 자식 프로세스의 PID 입니다.</p>

<p><img src="/assets/images/computer/img124.png" alt="img124" /></p>

<h6 id="fork-예제-코드">fork 예제 코드</h6>
<div data-lang="C" class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
</span>
<span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>

  <span class="n">pid_t</span> <span class="n">pid</span><span class="p">;</span>

  <span class="n">printf</span><span class="p">(</span><span class="s">"first_PID: %ld</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">getpid</span><span class="p">());</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"first_PPID: %ld</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">getppid</span><span class="p">());</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"---------------------</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>

  <span class="n">pid</span> <span class="o">=</span> <span class="n">fork</span><span class="p">();</span>

  <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">if</span><span class="p">(</span><span class="n">pid</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">"Error"</span><span class="p">);</span>
      <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">pid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">"Child Process!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">"Parent Process!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"PID: %ld</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">getpid</span><span class="p">());</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"PPID: %ld</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">getppid</span><span class="p">());</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"saved PID: %ld</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">pid</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"---------------------</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>

    <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h6 id="실행-결과">실행 결과</h6>
<p><img src="/assets/images/computer/img125.png" alt="img125" /></p>

<p>실행 결과를 살펴보면 first_PID와 first_PPID가 부모 프로세스의 PID, PPID와 동일하다는 것을 볼 수 있습니다. 부모 프로세스와 자식 프로세스가 동기화되어 실행되는 것 처럼 보이지만 실제로는 독립적으로 실행되고 있습니다.</p>

<p>fork 시스템 호출을 요청하면 부모 프로세스에는 자식 프로세스의 PID를 리턴하고, 자식 프로세스에는 0을 리턴합니다. 또한 자식 프로세스는 부모 프로세스의 PCB를 상속받았기 때문에 프로그램 카운터가 동일하여 fork 시스템 호출을 요청한 이후의 코드가 실행됩니다. 그렇기 때문에 자식 프로세스에서는 firt_PID와 first_PPID를 출력하지 않습니다.</p>

<hr />

<p>자식 프로세스에서 새로운 프로그램을 실행하려면 <code class="language-plaintext highlighter-rouge">exec</code> 시스템 호출을 요청하면 됩니다. exec 시스템 호출을 요청하면 자식 프로세스의 코드 영역을 새로운 코드로 교체하고 PCB에서 프로그램 카운터나 각종 레지스터, 파일 정보 등이 리셋됩니다.</p>

<p><img src="/assets/images/computer/img126.png" alt="img126" /></p>

<h6 id="exec-예제-코드-parent">exec 예제 코드: parent</h6>
<div data-lang="C" class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
</span>
<span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>

  <span class="n">pid_t</span> <span class="n">cpid</span><span class="p">;</span>

  <span class="n">printf</span><span class="p">(</span><span class="s">"parent process!!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>

  <span class="n">cpid</span> <span class="o">=</span> <span class="n">fork</span><span class="p">();</span>

  <span class="k">if</span><span class="p">(</span><span class="n">cpid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">exec</span><span class="p">(</span><span class="s">"./child"</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"child process failed to exec</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">xit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">wait</span><span class="p">();</span>
  <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h6 id="exec-예제-코드-child">exec 예제 코드: child</h6>
<div data-lang="C" class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
</span>
<span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"child process!!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h6 id="실행-결과-1">실행 결과</h6>
<p><img src="/assets/images/computer/img127.png" alt="img127" /></p>

<p>부모 프로세스가 먼저 종료되면 자식 프로세스도 종료되기 때문에 parent 코드에서 wait 함수를 통해 자식 프로세스와 동기화 시킵니다.</p>

<p>parent를 실행하면 fork 시스템 호출에 의해 자식 프로세스가 생성되고, exec 시스템 호출에 의해 자식 프로세스는 child를 실행합니다. 코드 영역이 child 코드로 변경되었기 때문에 “child process failed to exec” 라는 메시지는 출력되지 않습니다.</p>

<p>fork와 exec를 통해 프로세스를 생성하는 방식은 프로세스 생성 과정 전체를 거치지 않기 때문에 프로세스 생성 속도가 빠르고 추가 작업 없이 자원의 상속이 가능하여 시스템 관리에 효율적입니다.</p>

                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            <!-- 
                <section class="subscribe-form">
                    <h3 class="subscribe-form-title">Subscribe to Rubisco's Programming Note</h3>
                    <p>Get the latest posts delivered right to your inbox</p>
                    <span id="searchform" method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  />
    <input class="location" type="hidden" name="location"  />
    <input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" onkeyup="myFunc()" 
               id="searchtext" type="text" name="searchtext"  
               placeholder="Search..." />
    </div>
    <script type="text/javascript">
        function myFunc() {
            if(event.keyCode == 13) {
                var url = encodeURIComponent($("#searchtext").val());
                location.href = "/search.html?query=" + url;
            }
        }
    </script>
</span>
                </section>
             -->

            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                
                <!-- /author  -->
            </footer>

            <!-- utterances -->
            <div id="comment">
                <script src="https://utteranc.es/client.js"
                repo="huimang2/huimang2.github.io"
                issue-term="pathname"
                theme="github-light"
                crossorigin="anonymous"
                async></script>
            </div>
        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
                    <article class="read-next-card"
                        
                            style="background-image: url(/assets/images/M31_starspike.jpg)"
                        
                    >
                        <header class="read-next-card-header">
                            <small class="read-next-card-header-sitetitle">&mdash; Rubisco's Programming Note &mdash;</small>
                            
                                <h3 class="read-next-card-header-title"><a href="/tag/etc/">Etc</a></h3>
                            
                        </header>
                        <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
                        <div class="read-next-card-content">
                            <ul>
                                
                                
                                  
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/etc/computer-operating-system">운영체제</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/etc/computer-input-output-unit">입출력장치</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/etc/computer-instruction-pipeline">명령어 파이프라인</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                            </ul>
                        </div>
                        <footer class="read-next-card-footer">
                            <a href="/tag/etc/">
                                
                                    See all 12 posts  →
                                
                            </a>
                        </footer>
                    </article>
                
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/etc/computer-operating-system">
                <div class="post-card-image" style="background-image: url(/assets/images/computer-logo.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/etc/computer-operating-system">
                <header class="post-card-header">
                    
                        <div class="post-card-tags-container">
                            
                        </div>
                    

                    <h2 class="post-card-title">운영체제</h2>
                </header>
                <!-- <section class="post-card-excerpt">
                    
                        <p>운영체제(Operating System)란?

</p>
                    
                </section> -->
            </a>
            <footer class="post-card-meta">
                
                    
                
                <span class="reading-time">
                    
                    
                      3 min read
                    
                </span>
            </footer>
        </div>
    </article>

            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="https://huimang2.github.io/">
            
            <span>Rubisco's Programming Note</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">프로세스</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4&amp;url=etc/computer-process"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=etc/computer-process"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>



        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://huimang2.github.io/">Rubisco's Programming Note</a> &copy; 2023</section>
                <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> &
                    <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> using
                    <a href="https://github.com/jekyllt/jasper2" target="_blank" rel="noopener">Jasper2</a></section>
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    
                    
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    
    <div id="subscribe" class="subscribe-overlay">
        <a class="subscribe-overlay-close" href="#"></a>
        <div class="subscribe-overlay-content">
            
            <h1 class="subscribe-overlay-title">Search Rubisco's Programming Note</h1>
            <p class="subscribe-overlay-description">
            lunr.js를 이용한 posts 검색 </p>
            <span id="searchform" method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  />
    <input class="location" type="hidden" name="location"  />
    <input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" onkeyup="myFunc()" 
               id="searchtext" type="text" name="searchtext"  
               placeholder="Search..." />
    </div>
    <script type="text/javascript">
        function myFunc() {
            if(event.keyCode == 13) {
                var url = encodeURIComponent($("#searchtext").val());
                location.href = "/search.html?query=" + url;
            }
        }
    </script>
</span>
        </div>
    </div>


    <!-- highlight.js -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script> -->

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    /* toc ---------------------------------------------------------------------*/

    var tocTitle = document.getElementsByClassName("post-full-title")[0];
    var tocTitleY = window.pageYOffset + title.getBoundingClientRect().top;
    
    var tocArticle = document.getElementsByClassName("post-full-content")[0];
    var tocArticleY = window.pageYOffset + tocArticle.getBoundingClientRect().top;
  
    var toc = document.getElementById("toc");
    var tocHeaderNodes = getHeaderNodes(tocArticle);
    var tocNodes = getTOCNodes(toc);
  
    var tocBefore = undefined;

    function getTOCNodes(master) {
        var nodes = Array.prototype.slice.call(master.getElementsByTagName("*"), 0);
        var tocNodes = nodes.filter(function(elem) {
            return elem.tagName == "A";
        });
        return tocNodes;
    }
    
    function getHeaderNodes(master) {
        var nodes = Array.prototype.slice.call(master.getElementsByTagName("*"), 0);
        var headerNodes = nodes.filter(function(elem) {
            return elem.tagName == "H1" || elem.tagName == "H2" || elem.tagName == "H3" && !elem.classList.contains('no-toc');
        });
        return headerNodes;
    }

    tocNodes.forEach(el => {
        el.addEventListener('click', function(e){
            e.preventDefault();
            let id = this.getAttribute('href').slice(1);
            window.scrollTo(window.scrollX, window.scrollY + document.getElementById(id).getBoundingClientRect().top - 80);
        });
    });

    document.querySelector('.post-full-content').querySelectorAll('p a[href^="#"]').forEach(el => {
        el.addEventListener('click', function(e){
            e.preventDefault();
            let id = this.getAttribute('href').slice(1);
            window.scrollTo(window.scrollX, window.scrollY + document.getElementById(id).getBoundingClientRect().top - 80);
        });
    });

    /*--------------------------------------------------------------------------*/

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 30;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
            toc.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
            toc.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;

        // toc
        var tocCurrent = tocHeaderNodes.filter(function(header) {
            var headerY = window.pageYOffset + header.getBoundingClientRect().top;
            return window.scrollY >= headerY - 90;
        });
  
        if (tocCurrent.length > 0) {
            tocCurrent = tocCurrent[tocCurrent.length-1];
  
            var tocCurrentA = tocNodes.filter(function(tocNode) {
                return tocNode.getElementsByTagName("span")[0].innerHTML == tocCurrent.innerHTML;
            })
            
            tocCurrentA = tocCurrentA[0];

            if (tocCurrentA) {
                if (tocBefore == undefined) tocBefore = tocCurrentA;
    
                if (tocBefore != tocCurrentA) {
                    tocBefore.classList.remove("toc-active");
                    tocBefore = tocCurrentA;
                }
    
                tocCurrentA.classList.add("toc-active");
            }
            else {
                if (tocBefore) 
                    tocBefore.classList.remove("toc-active");
            }
        }
        else {
            if (tocBefore) 
                tocBefore.classList.remove("toc-active");
        }
        
        if(toc && tocArticle.getBoundingClientRect().bottom <= 0) {
            toc.classList.add('toc-hidden');
        } else {
            toc.classList.remove('toc-hidden');
        }
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
